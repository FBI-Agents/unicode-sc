<!DOCTYPE html>
    <html lang="en">
        <head>
            <meta charset="utf-8">
            <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
            <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
            <link rel="stylesheet" href="signup.css">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Caveat">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+JP">
            <title>Trojan Connect Sign Up</title>
        </head>
        <body>
            <div class="container-fluid main">
                <nav class="navbar navbar-light justify-content-start shadow">
                    <span class="navbar-brand">
                        <img src="images/logo.png" width="60" height="60" loading="lazy" alt="Trojan Connect">
                    </span>
                    <form class="form-inline ">
                        <input class="form-control search-bar" type="text" placeholder="Search your fellow trojans!">
                        <button class="btn btn-outline-danger search-button" type="submit">
                            <svg width="20" height="20" viewBox="0 0 16 16" class="bi bi-search" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z"/>
                                <path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"/>
                            </svg>
                        </button>
                    </form>
                    <a href="home.html" id="profile" class="btn text-center home" role="button">
                        <svg width="30" height="30" viewBox="0 0 16 16" class="bi bi-house-door" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M7.646 1.146a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 .146.354v7a.5.5 0 0 1-.5.5H9.5a.5.5 0 0 1-.5-.5v-4H7v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .146-.354l6-6zM2.5 7.707V14H6v-4a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4h3.5V7.707L8 2.207l-5.5 5.5z"/>
                            <path fill-rule="evenodd" d="M13 2.5V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/>
                        </svg>
                    </a> 
                </nav>
            </div>

            <div class="signup">
                <div class="align-middle wrapper">
                    <img class="login-pic" src="images/trojan.png" width="60" height="60">
                    <form method="POST" class="form needs-validation " id="register" onsubmit="return signup()">
                        <div class="form-group row justify-content-center">
                            <label class="col-sm-2 col-form-label" >Username:</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" id="username" placeholder="Username" required>
                            </div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <label class="col-sm-2 col-form-label" >First Name:</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" id="First-name" placeholder="First Name">
                            </div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <label class="col-sm-2 col-form-label" >Last Name:</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" id="Last-name" placeholder="Last Name">
                            </div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <label for="Email" class="col-sm-2 col-form-label" >Email:</label>
                            <div class="col-sm-8">
                                <input type="email" class="form-control" id="Email" placeholder="Email">
                            </div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <label class="col-sm-2 col-form-label" >Class Standing:</label>
                            <div class="col-sm-8">
                                <select id="standings" class="form-control" required>
                                    <option value="" class="hidden">Choose Here</option>
                                    <optgroup label="Undergraduate">
                                        <option value="Freshman">Undergraduate - Freshman</option>
                                        <option value="Sophomore">Undergraduate - Sophomore</option>
                                        <option value="Junior">Undergraduate - Junior</option>
                                        <option value="Senior">Undergraduate - Senior</option>
                                    </optgroup>
                                    <option value="Graduate">Graduate</option>
                                    <option value="PhD">PhD</option>
                                    <option value="Alumni">Alumni</option>
                                    <option value="Faculty">Faculty</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <label class="col-sm-2 col-form-label" >School:</label>
                            <div class="col-sm-8">
                                <select class="form-control" id="school">
                                    <option value="" class="hidden">Choose Here</option>
                                    <option value="Dornsife College of Letters, Arts and Sciences">Dornsife College of Letters, Arts and Sciences</option>
                                    <option value="USC School of Architecture">USC School of Architecture</option>
                                    <option value="Roski School of Art and Design">Roski School of Art and Design</option>
                                    <option value="Iovine and Young Academy for Arts, Technology and the Business of Innovation">Iovine and Young Academy for Arts, Technology and the Business of Innovation</option>
                                    <option value="Marshall School of Business">Marshall School of Business</option>
                                    <option value="USC School of Cinematic Arts">USC School of Cinematic Arts</option>
                                    <option value="Annenberg School for Communication and Journalism">Annenberg School for Communication and Journalism</option>
                                    <option value="Kaufman School of Dance">Kaufman School of Dance</option>
                                    <option value="Ostrow School of Dentistry">Ostrow School of Dentistry</option>
                                    <option value="USC School of Dramatic Arts">USC School of Dramatic Arts</option>
                                    <option value="Viterbi School of Engineering">Viterbi School of Engineering</option>
                                    <option value="Davis School of Gerontology">Davis School of Gerontology</option>
                                    <option value="Keck School of Medicine">Keck School of Medicine</option>
                                    <option value="Thornton School of Music">Thornton School of Music</option>
                                    <option value="Chan Division of Occupational Science and Occupational Therapy">Chan Division of Occupational Science and Occupational Therapy</option>
                                    <option value="USC School of Pharmacy">USC School of Pharmacy</option>
                                    <option value="Price School of Public Policy">Price School of Public Policy</option>
                                    <option value="Pre-professional Emphases">Pre-professional Emphases</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <label for="Password" class="col-sm-2 col-form-label">Password:</label>
                            <div class="col-sm-8">
                                <input type="password" class="form-control" id="Password" placeholder="Password">
                            </div>
                        </div>
                        <br>
                        <div class="form-group row justify-content-center signin">
                            <div class="col-sm-3">
                                <button class="btn btn-outline-danger form-control" id="submit" type="submit">Sign Up</button>
                            </div>
                        </div>
                        <div class="form-group row justify-content-center">
                            <label class="col-sm-9 reminder">
                                Already had account? <a href="login.html">Click here</a> to login.
                            </label>
                        </div>
                    </form>
                </div>
            </div>
            <button type="button" id="results" class="btn btn-info btn-lg hidden"data-backdrop="static" data-toggle="modal" data-target="#myModal">Open Modal</button>
            <div id="myModal" class="modal fade hidden" role="dialog">
                <div class="modal-dialog">
              
                  <!-- Modal content-->
                <div class="modal-content" style="position: relative; margin-left: auto; margin-right: auto;">
                    <div class="modal-header">
                      <h4 class="modal-title" id="titles" style="text-align: center; position: relative; left: 0px;">Registration Succeed!</h4>
                    </div>
                    <div class="modal-body" id="text-body">
                      <p>Now you can login with your newly created account. You will be redirected to
                          login page.
                      </p>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-default" data-backdrop="static" data-dismiss="modal" onclick="redirect()">Close</button>
                    </div>
                  </div>
              
                </div>
            </div>

            <script>

                function stay(){

                    return false;
                }

                function signup(){
                    
                    var xhttp = new XMLHttpRequest();
                    xhttp.open("POST", "http://localhost:8080/api/auth/signup", false);
                    xhttp.setRequestHeader("Content-Type", "application/json");
                    var e = document.getElementById("standings");
                    var f = document.getElementById("school");
                    var param = {
                        "first_name": document.getElementById("First-name").value,
                        "last_name" : document.getElementById("Last-name").value,
                        "email"     : document.getElementById("Email").value,
                        "password"  : document.getElementById("Password").value,
                        "username"  : document.getElementById("username").value,
                        "standings" : e.options[e.selectedIndex].value,
                        "school"    : f.options[f.selectedIndex].value
                        }
                        
                    xhttp.send(JSON.stringify(param));
                    alert(xhttp.response)
                    sessionStorage.setItem("status", xhttp.response);
                    if (xhttp.status == 200 || xhttp.status == 201){
                        
                    }
                    else{
                        document.getElementById("titles").innerHTML = "Registration Failed";
                        document.getElementById("text-body").innerHTML = "This username has been taken please try again."
                        document.getElementById("results").setAttribute("onclick", "return stay()");
                    }
                    document.getElementById("results").click();
                    return false;
                    
                }

                function redirect(){
                    location.replace("login.html")
                }

                
            </script>
            <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
            <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
            <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
    </html>